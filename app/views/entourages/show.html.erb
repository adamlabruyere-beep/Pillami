<div class="min-h-screen py-12 px-4">
  <div class="max-w-2xl mx-auto space-y-8">
    <div class="text-center">
      <h2 class="text-3xl font-bold text-gray-900">Mon entourage</h2>
      <p class="mt-2 text-sm text-gray-600">Gérez les personnes qui peuvent suivre vos traitements</p>
    </div>

    <% if flash[:notice] %>
      <div class="bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
        <%= flash[:notice] %>
      </div>
    <% end %>

    <% if flash[:alert] %>
      <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
        <%= flash[:alert] %>
      </div>
    <% end %>

    <!-- Ajouter un membre -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-medium text-gray-900 mb-4">Ajouter un membre</h3>
      <%= form_with url: entourage_entourage_members_path, method: :post, class: "flex gap-3" do |f| %>
        <%= f.email_field :email,
              placeholder: "Email de la personne à ajouter",
              required: true,
              class: "flex-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
        <%= f.submit "Ajouter",
              class: "px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer" %>
      <% end %>
    </div>

    <!-- Liste des membres -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Membres (<%= @members.count %>)</h3>
      </div>

      <% if @members.any? %>
        <ul class="divide-y divide-gray-200">
          <% @entourage.entourage_members.each do |membership| %>
            <li class="px-6 py-4 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="size-10 rounded-full overflow-hidden bg-blue-600 flex items-center justify-center text-white font-medium shrink-0">
                  <% if membership.user.photo.attached? %>
                    <%= cl_image_tag membership.user.photo.key, crop: :fill, width: 40, height: 40, class: "size-10 object-cover" %>
                  <% else %>
                    <%= membership.user.email[0].upcase %>
                  <% end %>
                </div>
                <div>
                  <p class="font-medium text-gray-900"><%= membership.user.prenom %> <%= membership.user.nom %></p>
                  <p class="text-sm text-gray-500"><%= membership.user.email %></p>
                </div>
              </div>
              <%= button_to entourage_entourage_member_path(membership),
                    method: :delete,
                    data: { turbo_confirm: "Êtes-vous sûr de vouloir retirer #{membership.user.prenom} de votre entourage ?" },
                    class: "text-red-600 hover:text-red-800 text-sm font-medium" do %>
                Retirer
              <% end %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="px-6 py-8 text-center text-gray-500">
          <p>Vous n'avez pas encore de membres dans votre entourage.</p>
          <p class="text-sm mt-1">Ajoutez des personnes en utilisant leur adresse email.</p>
        </div>
      <% end %>
    </div>

    <!-- Personnes que je suis -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Personnes que je suis (<%= @following.count %>)</h3>
        <p class="text-sm text-gray-500 mt-1">Ces personnes vous ont ajouté à leur entourage</p>
      </div>

      <% if @following.any? %>
        <ul class="divide-y divide-gray-200">
          <% @following.each do |entourage| %>
            <li class="px-6 py-4 flex items-center gap-3">
              <div class="size-10 rounded-full overflow-hidden bg-green-600 flex items-center justify-center text-white font-medium shrink-0">
                <% if entourage.user.photo.attached? %>
                  <%= cl_image_tag entourage.user.photo.key, crop: :fill, width: 40, height: 40, class: "size-10 object-cover" %>
                <% else %>
                  <%= entourage.user.email[0].upcase %>
                <% end %>
              </div>
              <div>
                <p class="font-medium text-gray-900"><%= entourage.user.prenom %> <%= entourage.user.nom %></p>
                <p class="text-sm text-gray-500"><%= entourage.user.email %></p>
              </div>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="px-6 py-8 text-center text-gray-500">
          <p>Vous ne suivez personne pour le moment.</p>
          <p class="text-sm mt-1">Quand quelqu'un vous ajoutera à son entourage, il apparaîtra ici.</p>
        </div>
      <% end %>
    </div>

    <div class="text-center">
      <%= link_to "← Retour", root_path, class: "text-sm font-medium text-gray-600 hover:text-gray-500" %>
    </div>
  </div>
</div>
