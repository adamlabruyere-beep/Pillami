<div class="min-h-screen flex items-center justify-center py-12 px-4">
  <div class="max-w-lg w-full space-y-8">

    <div class="text-center">
      <h2 class="text-3xl font-bold text-gray-900">Ajouter un rappel</h2>
      <p class="mt-2 text-sm text-gray-600">Choisissez votre médicament et configurez le rappel</p>
    </div>

    <%= form_with model: [@user, @reminder], local: true do |f| %>
      <% if @reminder.errors.any? %>
        <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4">
          <h3>Veuillez corriger les erreurs ci-dessous :</h3>
          <ul>
            <% @reminder.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- Médicament -->
      <div class="mb-4">
        <%= f.label :medicament_id, "Médicament", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.collection_select :medicament_id, @medicaments, :id, :nom,
              { prompt: "Sélectionnez un médicament" },
              class: "w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>


          <% days = Date::DAYNAMES.rotate(1) %>

      <fieldset class="fieldset bg-base-100 border-base-300 rounded-box w-full border p-4 mb-4">
        <legend class="fieldset-legend font-medium">Choisissez les jours</legend>
          <% selected_days = @reminder.days_of_week || [] %>

        <div class="grid grid-cols-2 gap-2">
          <% days.each do |day| %>
            <label class="flex items-center space-x-2">
              <%= check_box_tag "reminder[days_of_week][]", day, selected_days.include?(day), class: "checkbox" %>
              <span class="label-text">
                <%= I18n.t("date.day_names")[Date::DAYNAMES.index(day)] %>
              </span>
            </label>
          <% end %>
        </div>
      </fieldset>


      <!-- Affichage des jours choisis -->
      <p>
        Jours :
        <%= @reminder.days_of_week&.map { |d| I18n.t("date.day_names")[Date::DAYNAMES.index(d)] }&.join(", ") || "Aucun" %>
      </p>

      <div class="mb-4">
        <%= f.label :repeat_for_weeks, "Répéter pendant (semaines)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.number_field :repeat_for_weeks,
              min: 1,
              value: 1,
              class: "w-full px-3 py-2 border rounded-lg" %>
      </div>

      <!-- Heure du rappel -->
      <div class="mb-4">
        <%= f.label :time, "Heure du rappel", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.time_field :time, required: true,
              class: "w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>

      <!-- Quantité et mesure -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
          <%= f.label :quantity, "Quantité", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.select :quantity, [1,2,3,4,5], {}, class: "w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
        </div>
        <div>
          <%= f.label :measure, "Mesure", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.select :measure, ['Comprimé','Demi comprimé','Cuillère'], {}, class: "w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
        </div>
      </div>

      <!-- Bouton soumettre -->
      <div>
        <%= f.submit "Créer le rappel",
              class: "w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer" %>
      </div>
    <% end %>

    <!-- Lien retour -->
    <div class="text-center mt-4">
      <%= link_to "← Retour", user_reminders_path(@user), class: "text-sm font-medium text-gray-600 hover:text-gray-500" %>
    </div>

  </div>
</div>
