<div data-controller="calendrier" data-calendrier-index-value="<%= @initial_index %>" class="min-h-screen flex flex-col items-center justify-center">
  <div class="container mx-auto">
    <div class="justify-items-center items-center text-center space-y-8">
      <div>
        <p>Semaine du</p>
        <h1>
          <%= l(@week_days.first, format: "%d %B") %> — <%= l(@week_days.last, format: "%d %B %Y") %>
        </h1>
      </div>

      <div class="flex items-center justify-between">
        <%= link_to "◀︎ Semaine précédente",
            calendriers_path(date: @week_start - 7),
            class: "px-4 py-2 border rounded-lg hover:bg-gray-100" %>

        <%= link_to "Semaine suivante ▶︎",
            calendriers_path(date: @week_start + 7),
            class: "px-4 py-2 border rounded-lg hover:bg-gray-100" %>
      </div>

            <!-- CARROUSEL -->
      <div class="relative w-full max-w-sm mx-auto">
        <!-- bouton précédent -->
        <button
          type="button"
          data-action="click->calendrier#prev"
          class="absolute left-2 top-1/2 -translate-y-1/2
                md:-translate-x-full px-3 py-2 border rounded-full text-sm"
        >
          ◀
        </button>

        <!-- fenêtre du carrousel -->
        <div class="overflow-hidden">
          <!-- piste qui bouge + swipe -->
          <div
            data-calendrier-target="track"
            data-action="
              touchstart->calendrier#touchStart
              touchend->calendrier#touchEnd
            "
            class="flex transition-transform duration-300 ease-out"
          >
            <% @week_days.each do |date| %>
              <div
                data-calendrier-target="day"
                data-action="click->calendrier#select"
                data-date="<%= date %>"
                data-weekday="<%= l(date, format: '%A') %>"
                data-month="<%= l(date, format: '%B') %>"
                class="min-w-full flex justify-center"
              >
                <div class="w-40 aspect-square rounded-full border border-black
                            flex items-center justify-center cursor-pointer">
                  <div class="flex flex-col items-center text-center px-4 py-6 space-y-1">
                    <p class="text-sm leading-tight">
                      <%= l(date, format: "%A") %>
                    </p>
                    <p class="text-3xl font-semibold leading-none" data-role="day-number">
                      <%= date.day %>
                    </p>
                    <p class="text-sm leading-tight">
                      <%= l(date, format: "%B") %>
                    </p>
                    <div
                      data-calendrier-target="panel"
                      class="mt-2 text-sm"
                    ></div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>

        <!-- bouton suivant -->
        <button
          type="button"
          data-action="click->calendrier#next"
          class="absolute right-2 top-1/2 -translate-y-1/2
                md:translate-x-full px-3 py-2 border rounded-full text-sm"
        >
          ▶
        </button>
      </div>
    </div>
  </div>
</div>
